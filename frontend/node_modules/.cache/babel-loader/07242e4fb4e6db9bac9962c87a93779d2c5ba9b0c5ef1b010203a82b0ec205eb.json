{"ast":null,"code":"import axios from 'axios';\nexport default {\n  data() {\n    return {\n      village: {\n        id: null,\n        name: '',\n        description: '',\n        image: '',\n        committeeOverview: '',\n        committeeMembers: [],\n        committeeAchievements: '',\n        committeeTracking: '',\n        statusOverview: '',\n        statusStructure: '',\n        latitude: 0,\n        longitude: 0,\n        products: []\n      },\n      selectedFile: null,\n      selectedProductFiles: {},\n      villageCoordinates: '' // 新增属性，用于存储输入框的值\n    };\n  },\n  computed: {\n    villageImagePath() {\n      return this.village.image ? require(`@/assets/${this.village.image}`) : '';\n    }\n  },\n  methods: {\n    // 获取村庄信息\n    async fetchVillage() {\n      try {\n        const villageId = this.$route.params.villageId;\n        const [villageResponse, committeeResponse, statusResponse, locationResponse, productsResponse] = await Promise.all([axios.get(`http://localhost:5000/api/village/${villageId}`), axios.get(`http://localhost:5000/api/village_committee/${villageId}`),\n        // 修改此处\n        axios.get(`http://localhost:5000/api/village_status/${villageId}`), axios.get(`http://localhost:5000/api/village_location/${villageId}`), axios.get(`http://localhost:5000/api/villages/${villageId}/products`)]);\n        this.village = {\n          id: villageResponse.data.id,\n          name: villageResponse.data.name,\n          description: villageResponse.data.description,\n          image: villageResponse.data.image,\n          committeeOverview: committeeResponse.data.committee_overview,\n          committeeMembers: committeeResponse.data.committeeMembers || [],\n          // 确保包含 committeeMembers\n          committeeAchievements: committeeResponse.data.committee_achievements,\n          committeeTracking: committeeResponse.data.committee_tracking,\n          statusOverview: statusResponse.data.status_overview,\n          statusStructure: statusResponse.data.status_structure,\n          latitude: locationResponse.data.latitude,\n          longitude: locationResponse.data.longitude,\n          products: productsResponse.data.map(product => ({\n            ...product,\n            editing: false\n          }))\n        };\n\n        // 初始化输入框的值\n        this.villageCoordinates = `${this.village.latitude},${this.village.longitude}`;\n      } catch (error) {\n        console.error('获取村庄信息失败:', error);\n      }\n    },\n    // 更新村庄信息\n    async updateVillage() {\n      try {\n        const formData = new FormData();\n        formData.append('name', this.village.name);\n        formData.append('description', this.village.description);\n        formData.append('latitude', this.village.latitude);\n        formData.append('longitude', this.village.longitude);\n        formData.append('committeeOverview', this.village.committeeOverview);\n        formData.append('committeeMembers', JSON.stringify(this.village.committeeMembers)); // 确保转换为 JSON 字符串\n        formData.append('committeeAchievements', this.village.committeeAchievements);\n        formData.append('committeeTracking', this.village.committeeTracking);\n        formData.append('statusOverview', this.village.statusOverview);\n        formData.append('statusStructure', this.village.statusStructure);\n        if (this.selectedFile) {\n          formData.append('image', this.selectedFile);\n        } else {\n          console.warn('No file selected for upload');\n        }\n        console.log('FormData values:', Array.from(formData.values())); // 调试表单数据\n\n        // 先更新 VillageCommittee 记录\n        const response = await axios.put(`http://localhost:5000/api/village_committee/${this.village.id}`, formData, {\n          headers: {\n            'Content-Type': 'multipart/form-data'\n          }\n        });\n\n        // 获取更新后的 committeeId\n        const committeeId = response.data.committeeId;\n\n        // 更新或添加 CommitteeMember 记录\n        const committeeMembers = this.village.committeeMembers || [];\n        const existingMembers = committeeMembers.filter(member => member.id);\n        const newMembersToAdd = committeeMembers.filter(member => !member.id);\n\n        // 更新现有成员\n        for (const member of existingMembers) {\n          await axios.put(`http://localhost:5000/api/committee_members/${member.id}`, {\n            name: member.name,\n            role: member.role,\n            committeeId: committeeId // 确保 committeeId 被赋值\n          });\n        }\n\n        // 添加新成员\n        for (const newMember of newMembersToAdd) {\n          await axios.post(`http://localhost:5000/api/committee_members`, {\n            village_id: this.village.id,\n            name: newMember.name,\n            role: newMember.role,\n            committeeId: committeeId // 确保 committeeId 被赋值\n          });\n        }\n        alert('村庄信息更新成功');\n      } catch (error) {\n        console.error('更新村庄信息失败:', error);\n        if (error.response) {\n          alert(`更新村庄信息失败: ${error.response.data.error}`);\n        } else {\n          alert('更新村庄信息失败');\n        }\n      }\n    },\n    //将输入的经纬度更改格式到数据库\n    handleCoordinatesInput(event) {\n      const coordinates = event.target.value.trim(); // 去除前后空格\n      const [longitudeStr, latitudeStr] = coordinates.split(','); // 分割字符串\n\n      if (longitudeStr && latitudeStr) {\n        const longitude = parseFloat(longitudeStr); // 转换为浮点数\n        const latitude = parseFloat(latitudeStr); // 转换为浮点数\n\n        if (!isNaN(latitude) && !isNaN(longitude)) {\n          // 验证纬度范围 -90 到 90\n          if (latitude >= -90 && latitude <= 90) {\n            this.village.latitude = latitude;\n          } else {\n            console.error('纬度超出范围 (-90 到 90)');\n            alert('纬度超出范围 (-90 到 90)');\n            this.village.latitude = 0;\n          }\n\n          // 验证经度范围 -180 到 180\n          if (longitude >= -180 && longitude <= 180) {\n            this.village.longitude = longitude;\n          } else {\n            console.error('经度超出范围 (-180 到 180)');\n            alert('经度超出范围 (-180 到 180)');\n            this.village.longitude = 0;\n          }\n        } else {\n          console.error('无效的经纬度格式');\n          alert('无效的经纬度格式');\n          this.village.latitude = 0;\n          this.village.longitude = 0;\n        }\n      } else {\n        console.error('请输入完整的经纬度');\n        alert('请输入完整的经纬度');\n        this.village.latitude = 0;\n        this.village.longitude = 0;\n      }\n    },\n    //更新产品信息\n    async updateProduct(product) {\n      try {\n        const formData = new FormData();\n        formData.append('name', product.name);\n        formData.append('description', product.description);\n        formData.append('price', product.price);\n        if (this.selectedProductFiles[product.id]?.image) {\n          formData.append('image', this.selectedProductFiles[product.id].image);\n        }\n        if (this.selectedProductFiles[product.id]?.InfoImg) {\n          formData.append('InfoImg', this.selectedProductFiles[product.id].InfoImg);\n        }\n        await axios.put(`http://localhost:5000/api/products/${product.id}`, formData, {\n          headers: {\n            'Content-Type': 'multipart/form-data'\n          }\n        });\n        product.editing = false;\n        alert('产品信息更新成功');\n      } catch (error) {\n        console.error('更新产品信息失败:', error);\n        if (error.response) {\n          alert(`更新产品信息失败: ${error.response.data.error}`);\n        } else {\n          alert('更新产品信息失败');\n        }\n      }\n    },\n    handleDragEnd(e) {\n      this.longitude = e.point.lng;\n      this.latitude = e.point.lat;\n    },\n    handleImageUpload(event) {\n      if (event.target.files.length > 0) {\n        this.selectedFile = event.target.files[0];\n        console.log('Selected file:', this.selectedFile); // 调试选中的文件\n      } else {\n        console.warn('No file selected');\n      }\n    },\n    handleProductImageUpload(index) {\n      const file = event.target.files[0];\n      if (file) {\n        if (!this.selectedProductFiles[this.village.products[index].id]) {\n          this.selectedProductFiles[this.village.products[index].id] = {};\n        }\n        this.selectedProductFiles[this.village.products[index].id].image = file;\n      }\n    },\n    handleProductInfoImgUpload(index) {\n      const file = event.target.files[0];\n      if (file) {\n        if (!this.selectedProductFiles[this.village.products[index].id]) {\n          this.selectedProductFiles[this.village.products[index].id] = {};\n        }\n        this.selectedProductFiles[this.village.products[index].id].InfoImg = file;\n      }\n    },\n    addMember() {\n      this.village.committeeMembers.push({\n        name: '',\n        role: ''\n      });\n    },\n    removeMember(index) {\n      this.village.committeeMembers.splice(index, 1);\n    },\n    addProduct() {\n      this.village.products.push({\n        name: '',\n        description: '',\n        price: 0,\n        image: '',\n        InfoImg: '',\n        editing: true\n      });\n    },\n    editProduct(index) {\n      this.village.products[index].editing = true;\n    },\n    cancelEdit(index) {\n      this.village.products[index].editing = false;\n    },\n    deleteProduct(productId) {\n      if (confirm('确定要删除该产品吗？')) {\n        axios.delete(`http://localhost:5000/api/products/${productId}`).then(() => {\n          this.village.products = this.village.products.filter(product => product.id !== productId);\n          alert('产品删除成功');\n        }).catch(error => {\n          console.error('删除产品失败:', error);\n          alert('删除产品失败');\n        });\n      }\n    },\n    openMap() {\n      const mapUrl = `https://api.map.baidu.com/lbsapi/getpoint/index.html`;\n      const newWindow = window.open(mapUrl, '_blank', 'width=800,height=600');\n      const handleMessage = event => {\n        if (event.origin !== 'https://api.map.baidu.com') return; // 确保消息来自正确的源\n        if (!event.data || typeof event.data.lng !== 'number' || typeof event.data.lat !== 'number') {\n          console.error('接收到的地图数据无效:', event.data);\n          alert('接收到的地图数据无效，请重试');\n          return;\n        }\n        const {\n          lng,\n          lat\n        } = event.data;\n        this.village.longitude = lng;\n        this.village.latitude = lat;\n        window.removeEventListener('message', handleMessage);\n        newWindow.close();\n      };\n      window.addEventListener('message', handleMessage);\n\n      // 监听窗口关闭事件，以防用户手动关闭窗口\n      newWindow.onbeforeunload = () => {\n        window.removeEventListener('message', handleMessage);\n      };\n    },\n    getProductImagePath(image) {\n      return image ? require(`@/assets/${image}`) : '';\n    }\n  },\n  mounted() {\n    const villageId = this.$route.params.villageId;\n    console.log('Village ID:', villageId); // 添加日志输出\n    this.fetchVillage();\n  }\n};","map":{"version":3,"names":["axios","data","village","id","name","description","image","committeeOverview","committeeMembers","committeeAchievements","committeeTracking","statusOverview","statusStructure","latitude","longitude","products","selectedFile","selectedProductFiles","villageCoordinates","computed","villageImagePath","require","methods","fetchVillage","villageId","$route","params","villageResponse","committeeResponse","statusResponse","locationResponse","productsResponse","Promise","all","get","committee_overview","committee_achievements","committee_tracking","status_overview","status_structure","map","product","editing","error","console","updateVillage","formData","FormData","append","JSON","stringify","warn","log","Array","from","values","response","put","headers","committeeId","existingMembers","filter","member","newMembersToAdd","role","newMember","post","village_id","alert","handleCoordinatesInput","event","coordinates","target","value","trim","longitudeStr","latitudeStr","split","parseFloat","isNaN","updateProduct","price","InfoImg","handleDragEnd","e","point","lng","lat","handleImageUpload","files","length","handleProductImageUpload","index","file","handleProductInfoImgUpload","addMember","push","removeMember","splice","addProduct","editProduct","cancelEdit","deleteProduct","productId","confirm","delete","then","catch","openMap","mapUrl","newWindow","window","open","handleMessage","origin","removeEventListener","close","addEventListener","onbeforeunload","getProductImagePath","mounted"],"sources":["/home/toma/桌面/projects/RuralWebApp/frontend/src/components/VillageManagement.vue"],"sourcesContent":["<template>\r\n  <div class=\"village-management\">\r\n    <h2>村庄管理</h2>\r\n    \r\n    <div class=\"container\">\r\n      <!-- 左侧：村庄信息管理 -->\r\n      <div class=\"left-section\">\r\n        <div class=\"section\">\r\n          <h3>村况介绍</h3>\r\n          <form @submit.prevent=\"updateVillage\" enctype=\"multipart/form-data\">\r\n            <label for=\"villageName\">村庄名称:</label>\r\n            <input type=\"text\" id=\"villageName\" v-model=\"village.name\" required>\r\n            \r\n            <label for=\"villageDescription\">村庄描述:</label>\r\n            <textarea id=\"villageDescription\" v-model=\"village.description\"></textarea>\r\n            \r\n            <label for=\"villageLocation\">设置地址:</label>\r\n            <button id=\"villageLocation\" @click=\"openMap\">选取地点</button>\r\n            <label for=\"villageCoordinates\">设置经纬度:</label>\r\n            <input type=\"text\" id=\"villageCoordinates\" v-model=\"villageCoordinates\" placeholder=\"粘贴获取到的经纬度\" @input=\"handleCoordinatesInput\">\r\n\r\n            <div class=\"map-container\">\r\n              <h3>村庄位置</h3>\r\n              <baidu-map v-if=\"village.latitude && village.longitude\" class=\"small-map\" :center=\"{lng: village.longitude, lat: village.latitude}\" :zoom=\"15\">\r\n                <bm-marker :position=\"{lng: village.longitude, lat: village.latitude}\"></bm-marker>\r\n              </baidu-map>\r\n            </div>\r\n\r\n            <br />\r\n\r\n            <label for=\"villageImage\">上传图片:</label>\r\n            <input type=\"file\" id=\"villageImage\" name=\"image\" @change=\"handleImageUpload\">\r\n            <img v-if=\"village.image\" :src=\"villageImagePath\" alt=\"村庄图片\" style=\"width: 100px; height: 100px;\">\r\n            \r\n            <label for=\"villageCommitteeOverview\">村委总况介绍:</label>\r\n            <textarea id=\"villageCommitteeOverview\" v-model=\"village.committeeOverview\"></textarea>\r\n            \r\n            <label for=\"villageCommitteeMembers\">村委人员介绍:</label>\r\n            <div v-for=\"(member, index) in village.committeeMembers\" :key=\"index\" >\r\n              <input type=\"text\" v-model=\"member.name\" placeholder=\"姓名\" class=\"memberlist\">\r\n              <input type=\"text\" v-model=\"member.role\" placeholder=\"角色\" class=\"memberlist\">\r\n              <button @click.prevent=\"removeMember(index)\">删除</button>\r\n            </div>\r\n            <button @click.prevent=\"addMember\" style=\"margin-top: 0px;margin-bottom: 20px;\">新增成员</button>\r\n            \r\n            <label for=\"villageCommitteeAchievements\">村委业绩管理:</label>\r\n            <textarea id=\"villageCommitteeAchievements\" v-model=\"village.committeeAchievements\"></textarea>\r\n\r\n            <label for=\"villageCommitteeTracking\">村委工作跟踪:</label>\r\n            <textarea id=\"villageCommitteeTracking\" v-model=\"village.committeeTracking\"></textarea>\r\n\r\n            <label for=\"villageStatusOverview\">村况总况介绍:</label>\r\n            <textarea id=\"villageStatusOverview\" v-model=\"village.statusOverview\"></textarea>\r\n\r\n            <label for=\"villageStatusStructure\">村况结构管理:</label>\r\n            <textarea id=\"villageStatusStructure\" v-model=\"village.statusStructure\"></textarea>\r\n\r\n            <button type=\"submit\">保存村庄信息</button>\r\n          </form>\r\n        </div>\r\n      </div>\r\n\r\n      <!-- 右侧：产品信息管理 -->\r\n      <div class=\"right-section\">\r\n        <div class=\"section\">\r\n          <h3>一村一品</h3>\r\n          <div v-for=\"(product, index) in village.products\" :key=\"product.id\" class=\"product-card\">\r\n            <div v-if=\"!product.editing\">\r\n              <h4>{{ product.name }}</h4>\r\n              <p>{{ product.description }}</p>\r\n              <p>价格: {{ product.price }}</p>\r\n              <img :src=\"getProductImagePath(product.image)\" alt=\"产品图片\" style=\"width: 100px; height: 100px;\">\r\n              <button @click=\"editProduct(index)\">编辑</button>\r\n              <button @click=\"deleteProduct(product.id)\">删除</button>\r\n            </div>\r\n            <form v-else @submit.prevent=\"updateProduct(product)\">\r\n              <label>产品名称:</label>\r\n              <input type=\"text\" v-model=\"product.name\" required>\r\n              \r\n              <label>产品描述:</label>\r\n              <textarea v-model=\"product.description\"></textarea>\r\n              \r\n              <label>产品价格:</label>\r\n              <input type=\"number\" v-model=\"product.price\" required>\r\n              \r\n              <label>产品图片:</label>\r\n              <input type=\"file\" @change=\" handleProductImageUpload(index)\">\r\n              <img :src=\"getProductImagePath(product.image)\" alt=\"产品图片\" style=\"width: 100px; height: 100px;\">\r\n              \r\n              <label for=\"productInfoImg\">产品介绍图片:</label>\r\n              <input type=\"file\" @change=\" handleProductInfoImgUpload(index)\" />\r\n              <img v-if=\"product.InfoImg\" :src=\"getProductImagePath(product.InfoImg)\" alt=\"产品介绍图片\" />\r\n\r\n              <button type=\"submit\">保存</button>\r\n              <button @click=\"cancelEdit(index)\">取消</button>\r\n            </form>\r\n          </div>\r\n          <button type=\"button\" @click=\"addProduct\">添加新产品</button>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n<script>\r\nimport axios from 'axios';\r\n\r\nexport default {\r\n  data() {\r\n    return {\r\n      village: {\r\n        id: null,\r\n        name: '',\r\n        description: '',\r\n        image: '', \r\n        committeeOverview: '',\r\n        committeeMembers: [],\r\n        committeeAchievements: '',\r\n        committeeTracking: '',\r\n        statusOverview: '',\r\n        statusStructure: '',\r\n        latitude: 0,\r\n        longitude: 0,\r\n        products: []\r\n      },\r\n      selectedFile: null,\r\n      selectedProductFiles: {},\r\n      villageCoordinates: '' // 新增属性，用于存储输入框的值\r\n    };\r\n  },\r\n  computed: {\r\n    villageImagePath() {\r\n      return this.village.image\r\n        ? require(`@/assets/${this.village.image}`)\r\n        : '';\r\n    },\r\n  },\r\n  methods: {\r\n// 获取村庄信息\r\nasync fetchVillage() {\r\n  try {\r\n    const villageId = this.$route.params.villageId;\r\n    const [\r\n      villageResponse,\r\n      committeeResponse,\r\n      statusResponse,\r\n      locationResponse,\r\n      productsResponse\r\n    ] = await Promise.all([\r\n      axios.get(`http://localhost:5000/api/village/${villageId}`),\r\n      axios.get(`http://localhost:5000/api/village_committee/${villageId}`), // 修改此处\r\n      axios.get(`http://localhost:5000/api/village_status/${villageId}`),\r\n      axios.get(`http://localhost:5000/api/village_location/${villageId}`),\r\n      axios.get(`http://localhost:5000/api/villages/${villageId}/products`)\r\n    ]);\r\n\r\n    this.village = {\r\n      id: villageResponse.data.id,\r\n      name: villageResponse.data.name,\r\n      description: villageResponse.data.description,\r\n      image: villageResponse.data.image,\r\n      committeeOverview: committeeResponse.data.committee_overview,\r\n      committeeMembers: committeeResponse.data.committeeMembers || [], // 确保包含 committeeMembers\r\n      committeeAchievements: committeeResponse.data.committee_achievements,\r\n      committeeTracking: committeeResponse.data.committee_tracking,\r\n      statusOverview: statusResponse.data.status_overview,\r\n      statusStructure: statusResponse.data.status_structure,\r\n      latitude: locationResponse.data.latitude,\r\n      longitude: locationResponse.data.longitude,\r\n      products: productsResponse.data.map((product) => ({\r\n        ...product,\r\n        editing: false,\r\n      }))\r\n    };\r\n\r\n    // 初始化输入框的值\r\n    this.villageCoordinates = `${this.village.latitude},${this.village.longitude}`;\r\n  } catch (error) {\r\n    console.error('获取村庄信息失败:', error);\r\n  }\r\n},\r\n\r\n    // 更新村庄信息\r\nasync updateVillage() {\r\n  try {\r\n    const formData = new FormData();\r\n    formData.append('name', this.village.name);\r\n    formData.append('description', this.village.description);\r\n    formData.append('latitude', this.village.latitude);\r\n    formData.append('longitude', this.village.longitude);\r\n    formData.append('committeeOverview', this.village.committeeOverview);\r\n    formData.append('committeeMembers', JSON.stringify(this.village.committeeMembers)); // 确保转换为 JSON 字符串\r\n    formData.append('committeeAchievements', this.village.committeeAchievements);\r\n    formData.append('committeeTracking', this.village.committeeTracking);\r\n    formData.append('statusOverview', this.village.statusOverview);\r\n    formData.append('statusStructure', this.village.statusStructure);\r\n\r\n    if (this.selectedFile) {\r\n      formData.append('image', this.selectedFile);\r\n    } else {\r\n      console.warn('No file selected for upload');\r\n    }\r\n\r\n    console.log('FormData values:', Array.from(formData.values())); // 调试表单数据\r\n\r\n    // 先更新 VillageCommittee 记录\r\n    const response = await axios.put(\r\n      `http://localhost:5000/api/village_committee/${this.village.id}`,\r\n      formData,\r\n      {\r\n        headers: { 'Content-Type': 'multipart/form-data' },\r\n      }\r\n    );\r\n\r\n    // 获取更新后的 committeeId\r\n    const committeeId = response.data.committeeId;\r\n\r\n    // 更新或添加 CommitteeMember 记录\r\n    const committeeMembers = this.village.committeeMembers || [];\r\n    const existingMembers = committeeMembers.filter(member => member.id);\r\n    const newMembersToAdd = committeeMembers.filter(member => !member.id);\r\n\r\n    // 更新现有成员\r\n    for (const member of existingMembers) {\r\n      await axios.put(\r\n        `http://localhost:5000/api/committee_members/${member.id}`,\r\n        {\r\n          name: member.name,\r\n          role: member.role,\r\n          committeeId: committeeId // 确保 committeeId 被赋值\r\n        }\r\n      );\r\n    }\r\n\r\n    // 添加新成员\r\n    for (const newMember of newMembersToAdd) {\r\n      await axios.post(\r\n        `http://localhost:5000/api/committee_members`,\r\n        {\r\n          village_id: this.village.id,\r\n          name: newMember.name,\r\n          role: newMember.role,\r\n          committeeId: committeeId // 确保 committeeId 被赋值\r\n        }\r\n      );\r\n    }\r\n\r\n    alert('村庄信息更新成功');\r\n  } catch (error) {\r\n    console.error('更新村庄信息失败:', error);\r\n    if (error.response) {\r\n      alert(`更新村庄信息失败: ${error.response.data.error}`);\r\n    } else {\r\n      alert('更新村庄信息失败');\r\n    }\r\n  }\r\n},\r\n\r\n  //将输入的经纬度更改格式到数据库\r\n    handleCoordinatesInput(event) {\r\n  const coordinates = event.target.value.trim(); // 去除前后空格\r\n  const [longitudeStr, latitudeStr] = coordinates.split(','); // 分割字符串\r\n\r\n  if (longitudeStr && latitudeStr) {\r\n    const longitude = parseFloat(longitudeStr); // 转换为浮点数\r\n    const latitude = parseFloat(latitudeStr); // 转换为浮点数\r\n\r\n    if (!isNaN(latitude) && !isNaN(longitude)) {\r\n      // 验证纬度范围 -90 到 90\r\n      if (latitude >= -90 && latitude <= 90) {\r\n        this.village.latitude = latitude;\r\n      } else {\r\n        console.error('纬度超出范围 (-90 到 90)');\r\n        alert('纬度超出范围 (-90 到 90)');\r\n        this.village.latitude = 0;\r\n      }\r\n\r\n      // 验证经度范围 -180 到 180\r\n      if (longitude >= -180 && longitude <= 180) {\r\n        this.village.longitude = longitude;\r\n      } else {\r\n        console.error('经度超出范围 (-180 到 180)');\r\n        alert('经度超出范围 (-180 到 180)');\r\n        this.village.longitude = 0;\r\n      }\r\n    } else {\r\n      console.error('无效的经纬度格式');\r\n      alert('无效的经纬度格式');\r\n      this.village.latitude = 0;\r\n      this.village.longitude = 0;\r\n    }\r\n  } else {\r\n    console.error('请输入完整的经纬度');\r\n    alert('请输入完整的经纬度');\r\n    this.village.latitude = 0;\r\n    this.village.longitude = 0;\r\n  }\r\n},\r\n\r\n    //更新产品信息\r\n    async updateProduct(product) {\r\n      try {\r\n        const formData = new FormData();\r\n        formData.append('name', product.name);\r\n        formData.append('description', product.description);\r\n        formData.append('price', product.price);\r\n        if (this.selectedProductFiles[product.id]?.image) {\r\n          formData.append('image', this.selectedProductFiles[product.id].image);\r\n        }\r\n        if (this.selectedProductFiles[product.id]?.InfoImg) {\r\n          formData.append('InfoImg', this.selectedProductFiles[product.id].InfoImg);\r\n        }\r\n\r\n        await axios.put(\r\n          `http://localhost:5000/api/products/${product.id}`,\r\n          formData,\r\n          {\r\n            headers: { 'Content-Type': 'multipart/form-data' },\r\n          }\r\n        );\r\n        product.editing = false;\r\n        alert('产品信息更新成功');\r\n      } catch (error) {\r\n        console.error('更新产品信息失败:', error);\r\n        if (error.response) {\r\n          alert(`更新产品信息失败: ${error.response.data.error}`);\r\n        } else {\r\n          alert('更新产品信息失败');\r\n        }\r\n      }\r\n    },\r\n\r\n    handleDragEnd(e) {\r\n      this.longitude = e.point.lng;\r\n      this.latitude = e.point.lat;\r\n    },\r\n    \r\n  \r\n    handleImageUpload(event) {\r\n      if (event.target.files.length > 0) {\r\n        this.selectedFile = event.target.files[0];\r\n        console.log('Selected file:', this.selectedFile); // 调试选中的文件\r\n      } else {\r\n        console.warn('No file selected');\r\n      }\r\n    },\r\n\r\n    handleProductImageUpload(index) {\r\n        const file = event.target.files[0];\r\n        if (file) {\r\n          if (!this.selectedProductFiles[this.village.products[index].id]) {\r\n            this.selectedProductFiles[this.village.products[index].id] = {};\r\n          }\r\n          this.selectedProductFiles[this.village.products[index].id].image = file;\r\n        }\r\n      },\r\n    handleProductInfoImgUpload(index) {\r\n      const file = event.target.files[0];\r\n      if (file) {\r\n        if (!this.selectedProductFiles[this.village.products[index].id]) {\r\n          this.selectedProductFiles[this.village.products[index].id] = {};\r\n        }\r\n        this.selectedProductFiles[this.village.products[index].id].InfoImg = file;\r\n      }\r\n    },\r\n\r\n    addMember() {\r\n      this.village.committeeMembers.push({ name: '', role: '' });\r\n    },\r\n\r\n    removeMember(index) {\r\n      this.village.committeeMembers.splice(index, 1);\r\n    },\r\n\r\n    addProduct() {\r\n      this.village.products.push({\r\n        name: '',\r\n        description: '',\r\n        price: 0,\r\n        image: '',\r\n        InfoImg: '',\r\n        editing: true\r\n      });\r\n    },\r\n\r\n    editProduct(index) {\r\n      this.village.products[index].editing = true;\r\n    },\r\n\r\n    cancelEdit(index) {\r\n      this.village.products[index].editing = false;\r\n    },\r\n\r\n    deleteProduct(productId) {\r\n      if (confirm('确定要删除该产品吗？')) {\r\n        axios.delete(`http://localhost:5000/api/products/${productId}`)\r\n          .then(() => {\r\n            this.village.products = this.village.products.filter((product) => product.id !== productId);\r\n            alert('产品删除成功');\r\n          })\r\n          .catch((error) => {\r\n            console.error('删除产品失败:', error);\r\n            alert('删除产品失败');\r\n          });\r\n      }\r\n    },\r\n\r\n   openMap() {\r\n        const mapUrl = `https://api.map.baidu.com/lbsapi/getpoint/index.html`;\r\n        const newWindow = window.open(mapUrl, '_blank', 'width=800,height=600');\r\n\r\n        const handleMessage = (event) => {\r\n            if (event.origin !== 'https://api.map.baidu.com') return; // 确保消息来自正确的源\r\n            if (!event.data || typeof event.data.lng !== 'number' || typeof event.data.lat !== 'number') {\r\n                console.error('接收到的地图数据无效:', event.data);\r\n                alert('接收到的地图数据无效，请重试');\r\n                return;\r\n            }\r\n            const { lng, lat } = event.data;\r\n            this.village.longitude = lng;\r\n            this.village.latitude = lat;\r\n            window.removeEventListener('message', handleMessage);\r\n            newWindow.close();\r\n        };\r\n\r\n        window.addEventListener('message', handleMessage);\r\n\r\n        // 监听窗口关闭事件，以防用户手动关闭窗口\r\n        newWindow.onbeforeunload = () => {\r\n            window.removeEventListener('message', handleMessage);\r\n        };\r\n    },\r\n    \r\n\r\n    getProductImagePath(image) {\r\n      return image ? require(`@/assets/${image}`) : '';\r\n    }\r\n  },\r\n  mounted() {\r\n    const villageId = this.$route.params.villageId;\r\n    console.log('Village ID:', villageId); // 添加日志输出\r\n    this.fetchVillage();\r\n  }\r\n};\r\n</script>\r\n\r\n\r\n<style scoped>\r\n.village-management {\r\n  font-family: Arial, sans-serif;\r\n  color: #333;\r\n  background-color: #f0f0f0;\r\n  padding: 20px;\r\n  max-width: 1200px;\r\n  margin: 0 auto;\r\n}\r\n\r\nh2 {\r\n  font-size: 32px;\r\n  color: #2c3e50;\r\n  margin-bottom: 20px;\r\n  text-align: center;\r\n}\r\n\r\n.container {\r\n  display: flex;\r\n  justify-content: space-between;\r\n}\r\n\r\n.left-section, .right-section {\r\n  width: 48%;\r\n}\r\n\r\n.section {\r\n  width: 100%;\r\n  max-width: 800px;\r\n  margin-bottom: 30px;\r\n  border: 1px solid #e0e0e0;\r\n  padding: 20px;\r\n  border-radius: 8px;\r\n  background-color: #fff;\r\n  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);\r\n}\r\n\r\nh3 {\r\n  margin-top: 0;\r\n  margin-bottom: 15px;\r\n  color: #333;\r\n  font-size: 24px;\r\n  text-align: center;\r\n}\r\n\r\nlabel {\r\n  display: block;\r\n  margin-bottom: 5px;\r\n  font-size: 16px;\r\n  color: #555;\r\n}\r\n\r\ninput, textarea {\r\n  width: calc(100% - 20px); /* 减去右边距 */\r\n  padding: 10px;\r\n  margin-bottom: 15px;\r\n  border: 1px solid #e0e0e0;\r\n  border-radius: 5px;\r\n  font-size: 16px;\r\n}\r\n\r\n\r\nbutton {\r\n  margin-top: 20px;\r\n  padding: 10px 20px;\r\n  font-size: 16px;\r\n  color: #fff;\r\n  background-color: #007BFF;\r\n  border: none;\r\n  border-radius: 5px;\r\n  cursor: pointer;\r\n  transition: background-color 0.3s ease;\r\n}\r\n\r\nbutton:hover {\r\n  background-color: #0056b3;\r\n}\r\n\r\n.product-card {\r\n  margin-bottom: 20px;\r\n  border: 1px solid #e0e0e0;\r\n  padding: 15px;\r\n  border-radius: 8px;\r\n  background-color: #fff;\r\n  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);\r\n  transition: box-shadow 0.3s ease;\r\n}\r\n\r\n.product-card:hover {\r\n  box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);\r\n}\r\n\r\n.product-view h4 {\r\n  margin-top: 0;\r\n  font-size: 20px;\r\n  color: #333;\r\n}\r\n\r\n.product-view p {\r\n  margin: 5px 0;\r\n  font-size: 16px;\r\n  color: #555;\r\n}\r\n\r\n.member-item {\r\n  display: flex;\r\n  align-items: center;\r\n  margin-bottom: 10px;\r\n}\r\n\r\n.form-input {\r\n  margin-right: 10px;\r\n  padding: 5px;\r\n  border: 1px solid #e0e0e0;\r\n  border-radius: 5px;\r\n  flex: 1;\r\n}\r\n\r\n.form-button {\r\n  padding: 5px 10px;\r\n  background-color: #007BFF;\r\n  color: #fff;\r\n  border: none;\r\n  border-radius: 5px;\r\n  cursor: pointer;\r\n  transition: background-color 0.3s ease;\r\n}\r\n\r\n.form-button:hover {\r\n  background-color: #0056b3;\r\n}\r\n\r\n#map-container {\r\n  width: 300px;\r\n  height: 200px;\r\n  margin-top: 10px;\r\n  border: 1px solid #e0e0e0;\r\n  border-radius: 5px;\r\n}\r\n\r\n.small-map {\r\n  width: 100%;\r\n  height: 300px;\r\n  border: 1px solid #e0e0e0;\r\n  border-radius: 8px;\r\n  margin-top: 15px;\r\n}\r\n\r\n.map-container {\r\n  margin-top: 20px;\r\n}\r\n\r\n.product-form {\r\n  margin-bottom: 20px;\r\n}\r\n\r\n.edit-village-container {\r\n  display: flex;\r\n  justify-content: space-between;\r\n  padding: 20px;\r\n}\r\n\r\n.left-column, .right-column {\r\n  width: 48%;\r\n}\r\n\r\nform div {\r\n  margin-bottom: 15px;\r\n}\r\n\r\nlabel {\r\n  display: block;\r\n  margin-bottom: 5px;\r\n}\r\n\r\n.memberlist{\r\nwidth: 35% !important;\r\nmargin-right: 10px;\r\n}\r\n\r\n\r\ninput[type=\"text\"],\r\ninput[type=\"number\"],\r\ntextarea {\r\n  width: 100%;\r\n  padding: 8px;\r\n  box-sizing: border-box;\r\n}\r\n\r\nbutton {\r\n  padding: 10px 20px;\r\n  background-color: #007BFF;\r\n  color: white;\r\n  border: none;\r\n  border-radius: 5px;\r\n  cursor: pointer;\r\n  transition: background-color 0.3s, transform 0.3s;\r\n  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);\r\n}\r\n\r\nbutton:hover {\r\n  background-color: #0056b3;\r\n  transform: scale(1.05);\r\n  box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);\r\n}\r\n\r\n.product-form {\r\n  margin-bottom: 20px;\r\n}\r\n\r\n.map-container {\r\n  margin-top: 20px;\r\n}\r\n\r\n.small-map {\r\n  width: 100%;\r\n  height: 300px;\r\n  border: 1px solid #e0e0e0;\r\n  border-radius: 8px;\r\n  margin-top: 15px;\r\n}\r\n</style>"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}