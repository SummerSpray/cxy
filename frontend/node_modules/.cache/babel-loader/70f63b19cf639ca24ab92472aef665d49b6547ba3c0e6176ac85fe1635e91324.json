{"ast":null,"code":"import SwiperCore, { Autoplay, Pagination, Navigation } from 'swiper';\nimport { Swiper, SwiperSlide } from 'swiper/vue';\nimport 'swiper/swiper-bundle.min.css';\nimport NoticeBoard from \"@/components/NoticeBoard.vue\";\nimport { getUserLocation } from \"@/utils/locationService\";\n\n// 注册 Swiper 模块\nSwiperCore.use([Autoplay, Pagination, Navigation]);\nexport default {\n  components: {\n    Swiper,\n    SwiperSlide,\n    NoticeBoard\n  },\n  data() {\n    return {\n      autoplay: {\n        delay: 3000,\n        // 自动切换间隔（毫秒）\n        disableOnInteraction: false // 用户交互后继续自动切换\n      },\n      images: [],\n      // 图片数组\n      notices: [\"村庄活动即将开始\", \"新品上市通知\", \"科技团队发布成果\"],\n      location: null,\n      recommendedVillages: [],\n      // 动态获取村庄数据\n      defaultImage: require('@/assets/villages/default.jpg'),\n      visibleVillages: [],\n      // 可见村庄\n      showAll: false\n    };\n  },\n  methods: {\n    async fetchRecommendedVillages() {\n      try {\n        const response = await fetch(\"http://localhost:5000/api/village\");\n        if (!response.ok) {\n          throw new Error(`HTTP error! status: ${response.status}`);\n        }\n        const data = await response.json();\n\n        // 设置推荐村庄数据\n        this.recommendedVillages = data.map(village => ({\n          id: village.id,\n          name: village.name,\n          description: village.description || \"暂无描述\",\n          image: village.image ? require(`@/assets/${village.image}`) : this.defaultImage\n        }));\n\n        // 默认显示前5个村庄\n        this.visibleVillages = this.recommendedVillages.slice(0, 5);\n      } catch (error) {\n        console.error(\"获取村庄数据失败:\", error);\n      }\n    },\n    async loadImages() {\n      try {\n        const images = require.context('@/assets/bgImages', false, /\\.(png|jpe?g|gif)$/);\n        this.images = images.keys().map(imagePath => images(imagePath));\n      } catch (error) {\n        console.error(\"无法加载图片:\", error);\n      }\n    },\n    handleImageError(village) {\n      // 如果图片加载失败，将图片设置为默认图片\n      village.image = this.defaultImage;\n    }\n  },\n  async created() {\n    try {\n      this.location = await getUserLocation();\n      await this.fetchRecommendedVillages(); // 获取村庄数据\n      await this.loadImages(); // 获取滚动图片\n    } catch (error) {\n      console.error(\"初始化错误:\", error);\n    }\n  }\n};","map":{"version":3,"names":["SwiperCore","Autoplay","Pagination","Navigation","Swiper","SwiperSlide","NoticeBoard","getUserLocation","use","components","data","autoplay","delay","disableOnInteraction","images","notices","location","recommendedVillages","defaultImage","require","visibleVillages","showAll","methods","fetchRecommendedVillages","response","fetch","ok","Error","status","json","map","village","id","name","description","image","slice","error","console","loadImages","context","keys","imagePath","handleImageError","created"],"sources":["/home/toma/桌面/projects/RuralWebApp/frontend/src/views/Home.vue"],"sourcesContent":["<template>\r\n  <div>\r\n    <!-- 滚动图片 -->\r\n    <div class=\"carousel\">\r\n      <swiper\r\n        :loop=\"true\"\r\n        :autoplay=\"autoplay\"\r\n        pagination\r\n        navigation\r\n      >\r\n        <!-- 循环渲染图片 -->\r\n        <swiper-slide v-for=\"(image, index) in images\" :key=\"index\">\r\n          <img :src=\"image\" alt=\"滚动图片\" />\r\n        </swiper-slide>\r\n      </swiper>\r\n    </div>\r\n\r\n    <!-- 推荐村庄 -->\r\n    <h2>推荐村庄</h2>\r\n    <div class=\"village-list\">\r\n      <div\r\n        class=\"village-card\"\r\n        v-for=\"village in visibleVillages\"\r\n        :key=\"village.id\"\r\n      >\r\n        <img \r\n          :src=\"village.image || defaultImage\" \r\n          alt=\"村庄图片\" \r\n          class=\"village-image\" \r\n          @error=\"handleImageError(village)\" \r\n        />\r\n        <div class=\"village-info\">\r\n          <h3>{{ village.name }}</h3>\r\n          <p>{{ village.description }}</p>\r\n          <router-link :to=\"'/village/' + village.id\" class=\"village-link\">\r\n            查看详情\r\n          </router-link>\r\n        </div>\r\n      </div>\r\n    </div>\r\n    <router-link v-if=\"!showAll\" to=\"/village\" class=\"show-all-btn\">\r\n      展开全部\r\n    </router-link>\r\n\r\n    <!-- 通知 -->\r\n    <NoticeBoard :notices=\"notices\" />\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport SwiperCore, { Autoplay, Pagination, Navigation } from 'swiper';\r\nimport { Swiper, SwiperSlide } from 'swiper/vue';\r\nimport 'swiper/swiper-bundle.min.css';\r\nimport NoticeBoard from \"@/components/NoticeBoard.vue\";\r\nimport { getUserLocation } from \"@/utils/locationService\";\r\n\r\n// 注册 Swiper 模块\r\nSwiperCore.use([Autoplay, Pagination, Navigation]);\r\n\r\nexport default {\r\n  components: {\r\n    Swiper,\r\n    SwiperSlide,\r\n    NoticeBoard,\r\n  },\r\n  data() {\r\n    return {\r\n      autoplay: {\r\n        delay: 3000, // 自动切换间隔（毫秒）\r\n        disableOnInteraction: false, // 用户交互后继续自动切换\r\n      },\r\n      images: [], // 图片数组\r\n      notices: [\"村庄活动即将开始\", \"新品上市通知\", \"科技团队发布成果\"],\r\n      location: null,\r\n      recommendedVillages: [], // 动态获取村庄数据\r\n      defaultImage: require('@/assets/villages/default.jpg'),\r\n      visibleVillages: [], // 可见村庄\r\n      showAll: false,\r\n    };\r\n  },\r\n  methods: {\r\n    async fetchRecommendedVillages() {\r\n  try {\r\n    const response = await fetch(\"http://localhost:5000/api/village\");\r\n    if (!response.ok) {\r\n      throw new Error(`HTTP error! status: ${response.status}`);\r\n    }\r\n    const data = await response.json();\r\n\r\n    // 设置推荐村庄数据\r\n    this.recommendedVillages = data.map(village => ({\r\n      id: village.id,\r\n      name: village.name,\r\n      description: village.description || \"暂无描述\",\r\n      image: village.image ? require(`@/assets/${village.image}`) : this.defaultImage,\r\n    }));\r\n\r\n    // 默认显示前5个村庄\r\n    this.visibleVillages = this.recommendedVillages.slice(0, 5);\r\n  } catch (error) {\r\n    console.error(\"获取村庄数据失败:\", error);\r\n  }\r\n},\r\n    async loadImages() {\r\n      try {\r\n        const images = require.context('@/assets/bgImages', false, /\\.(png|jpe?g|gif)$/);\r\n        this.images = images.keys().map(imagePath => images(imagePath));\r\n      } catch (error) {\r\n        console.error(\"无法加载图片:\", error);\r\n      }\r\n    },\r\n    handleImageError(village) {\r\n      // 如果图片加载失败，将图片设置为默认图片\r\n      village.image = this.defaultImage;\r\n    },\r\n  },\r\n  async created() {\r\n    try {\r\n      this.location = await getUserLocation();\r\n      await this.fetchRecommendedVillages(); // 获取村庄数据\r\n      await this.loadImages(); // 获取滚动图片\r\n    } catch (error) {\r\n      console.error(\"初始化错误:\", error);\r\n    }\r\n  },\r\n};\r\n</script>\r\n\r\n<style scoped>\r\n/* 滚动图片样式 */\r\n.carousel {\r\n  width: 100%;\r\n  height: 450px;\r\n  margin-bottom: 20px;\r\n  overflow: hidden; /* 防止内容超出容器范围 */\r\n}\r\n\r\n.swiper-container {\r\n  width: 100%;\r\n  height: 100%;\r\n}\r\n\r\n.swiper-slide {\r\n  display: flex;\r\n  justify-content: center;\r\n  align-items: center;\r\n  height: 100%;\r\n}\r\n\r\n.swiper-slide img {\r\n  width: 100%;\r\n  height: 100%;\r\n  object-fit: cover;\r\n}\r\n\r\n/* 推荐村庄样式 */\r\nh2 {\r\n  margin-top: 20px;\r\n  font-size: 24px;\r\n  text-align: center;\r\n}\r\n\r\n.village-list {\r\n  display: grid;\r\n  grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));\r\n  gap: 20px;\r\n  padding: 10px;\r\n}\r\n\r\n.village-card {\r\n  border: 1px solid #ddd;\r\n  border-radius: 10px;\r\n  overflow: hidden;\r\n  box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);\r\n  transition: transform 0.3s;\r\n  background-color: #fff;\r\n}\r\n\r\n.village-card:hover {\r\n  transform: translateY(-5px);\r\n}\r\n\r\n.village-image {\r\n  width: 100%;\r\n  height: 150px;\r\n  object-fit: cover;\r\n}\r\n\r\n.village-info {\r\n  padding: 10px;\r\n  text-align: center;\r\n}\r\n\r\n.village-info h3 {\r\n  font-size: 20px;\r\n  margin: 10px 0;\r\n}\r\n\r\n.village-info p {\r\n  color: #666;\r\n  font-size: 14px;\r\n}\r\n\r\n.village-link {\r\n  display: inline-block;\r\n  margin-top: 10px;\r\n  padding: 5px 10px;\r\n  background-color: #007BFF;\r\n  color: #fff;\r\n  text-decoration: none;\r\n  border-radius: 5px;\r\n}\r\n\r\n.village-link:hover {\r\n  background-color: #0056b3;\r\n}\r\n\r\n/* 展示全部按钮样式 */\r\n.show-all-btn {\r\n  width: 100px;\r\n  display: block;\r\n  margin: 20px auto;\r\n  padding: 10px 20px;\r\n  font-size: 16px;\r\n  color: #fff;\r\n  background-color: #007BFF;\r\n  text-align: center;\r\n  text-decoration: none;\r\n  border-radius: 5px;\r\n}\r\n\r\n.show-all-btn:hover {\r\n  background-color: #0056b3;\r\n}\r\n</style>"],"mappings":"AAkDA,OAAOA,UAAU,IAAIC,QAAQ,EAAEC,UAAU,EAAEC,UAAS,QAAS,QAAQ;AACrE,SAASC,MAAM,EAAEC,WAAU,QAAS,YAAY;AAChD,OAAO,8BAA8B;AACrC,OAAOC,WAAU,MAAO,8BAA8B;AACtD,SAASC,eAAc,QAAS,yBAAyB;;AAEzD;AACAP,UAAU,CAACQ,GAAG,CAAC,CAACP,QAAQ,EAAEC,UAAU,EAAEC,UAAU,CAAC,CAAC;AAElD,eAAe;EACbM,UAAU,EAAE;IACVL,MAAM;IACNC,WAAW;IACXC;EACF,CAAC;EACDI,IAAIA,CAAA,EAAG;IACL,OAAO;MACLC,QAAQ,EAAE;QACRC,KAAK,EAAE,IAAI;QAAE;QACbC,oBAAoB,EAAE,KAAK,CAAE;MAC/B,CAAC;MACDC,MAAM,EAAE,EAAE;MAAE;MACZC,OAAO,EAAE,CAAC,UAAU,EAAE,QAAQ,EAAE,UAAU,CAAC;MAC3CC,QAAQ,EAAE,IAAI;MACdC,mBAAmB,EAAE,EAAE;MAAE;MACzBC,YAAY,EAAEC,OAAO,CAAC,+BAA+B,CAAC;MACtDC,eAAe,EAAE,EAAE;MAAE;MACrBC,OAAO,EAAE;IACX,CAAC;EACH,CAAC;EACDC,OAAO,EAAE;IACP,MAAMC,wBAAwBA,CAAA,EAAG;MACnC,IAAI;QACF,MAAMC,QAAO,GAAI,MAAMC,KAAK,CAAC,mCAAmC,CAAC;QACjE,IAAI,CAACD,QAAQ,CAACE,EAAE,EAAE;UAChB,MAAM,IAAIC,KAAK,CAAC,uBAAuBH,QAAQ,CAACI,MAAM,EAAE,CAAC;QAC3D;QACA,MAAMlB,IAAG,GAAI,MAAMc,QAAQ,CAACK,IAAI,CAAC,CAAC;;QAElC;QACA,IAAI,CAACZ,mBAAkB,GAAIP,IAAI,CAACoB,GAAG,CAACC,OAAM,KAAM;UAC9CC,EAAE,EAAED,OAAO,CAACC,EAAE;UACdC,IAAI,EAAEF,OAAO,CAACE,IAAI;UAClBC,WAAW,EAAEH,OAAO,CAACG,WAAU,IAAK,MAAM;UAC1CC,KAAK,EAAEJ,OAAO,CAACI,KAAI,GAAIhB,OAAO,CAAC,YAAYY,OAAO,CAACI,KAAK,EAAE,IAAI,IAAI,CAACjB;QACrE,CAAC,CAAC,CAAC;;QAEH;QACA,IAAI,CAACE,eAAc,GAAI,IAAI,CAACH,mBAAmB,CAACmB,KAAK,CAAC,CAAC,EAAE,CAAC,CAAC;MAC7D,EAAE,OAAOC,KAAK,EAAE;QACdC,OAAO,CAACD,KAAK,CAAC,WAAW,EAAEA,KAAK,CAAC;MACnC;IACF,CAAC;IACG,MAAME,UAAUA,CAAA,EAAG;MACjB,IAAI;QACF,MAAMzB,MAAK,GAAIK,OAAO,CAACqB,OAAO,CAAC,mBAAmB,EAAE,KAAK,EAAE,oBAAoB,CAAC;QAChF,IAAI,CAAC1B,MAAK,GAAIA,MAAM,CAAC2B,IAAI,CAAC,CAAC,CAACX,GAAG,CAACY,SAAQ,IAAK5B,MAAM,CAAC4B,SAAS,CAAC,CAAC;MACjE,EAAE,OAAOL,KAAK,EAAE;QACdC,OAAO,CAACD,KAAK,CAAC,SAAS,EAAEA,KAAK,CAAC;MACjC;IACF,CAAC;IACDM,gBAAgBA,CAACZ,OAAO,EAAE;MACxB;MACAA,OAAO,CAACI,KAAI,GAAI,IAAI,CAACjB,YAAY;IACnC;EACF,CAAC;EACD,MAAM0B,OAAOA,CAAA,EAAG;IACd,IAAI;MACF,IAAI,CAAC5B,QAAO,GAAI,MAAMT,eAAe,CAAC,CAAC;MACvC,MAAM,IAAI,CAACgB,wBAAwB,CAAC,CAAC,EAAE;MACvC,MAAM,IAAI,CAACgB,UAAU,CAAC,CAAC,EAAE;IAC3B,EAAE,OAAOF,KAAK,EAAE;MACdC,OAAO,CAACD,KAAK,CAAC,QAAQ,EAAEA,KAAK,CAAC;IAChC;EACF;AACF,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}